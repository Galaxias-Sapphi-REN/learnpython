# 函数

## 目录

## 调用函数

Python支持函数，不仅可以灵活地自定义函数，而且本身也内置了很多有用的函数。

除了可以使用help(函数名)查看内置函数（**built-in function, BIF**）的用法和用途，也可以直接查看[官方文档](https://docs.python.org/3/library/functions.html#abs)。

函数名其实就是指向一个函数对象的引用，完全可以把函数名赋给一个变量，相当于给这个函数起了一个**别名**。

```python
>>> a = abs # 变量a指向abs函数
>>> a(-1) # 所以也可以通过a调用abs函数
1
```

---

<br>

## 定义函数

定义函数要使用 `def` 语句，依次写出 *函数名*、*括号*、*括号中的参数* 和*冒号*，然后，在缩进块中编写函数体，函数的返回值用 `return` 语句返回。例如：

```python
def my_abs(x):
    if x >= 0:
        return x
    else:
        return -x
```

注意，如果没有return语句，则函数执行完毕也会返回 `None`，如果想要函数返回 `None`，除了写 `return None` 之外还可以直接写 `return`。

我们既可以直接在命令行定义函数，也可以把函数放在 `.py` 文件中定义。若采用后者,则使用函数时要先把工作目录跳转到文件保存的目录，再启动Python，然后用 `from 文件名 import 函数名` 即可导入函数。(这里文件名不需要包含文件扩展名 `.py`)

比方说把上面的 `my_abs` 函数写入到 `my_abs.py` 文件中，保存在桌面，使用该函数需要先 `cd` 到桌面目录，然后再导入和使用：

```python
C:\Users\Administrator>cd Desktop

C:\Users\Administrator\Desktop>python
Python 3.5.1 |Anaconda 4.0.0 (64-bit)| (default, Feb 16 2016, 09:49:46) [MSC v.1900 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> from my_abs import my_abs
>>> my_abs(5)
5
>>> my_abs(0)
0
>>> my_abs(-5)
5
```

---

### 空函数

如果还没想好怎么写一个函数，可以用 `pass` 语句来实现一个空函数，如：

```python
def nop():
    pass
```

`pass` 语句什么都不做，但可以用来做占位符。用在其他语句中也可以，如：

```python
if age >= 18:
    pass
```

---

### 参数检查

当**参数个数不对**时，Python解释器会抛出 `TypeError` 错误，但是当**参数类型错误**时，如果函数里面没有给出对应的方法，Python解释器就无法抛出正确的错误提示信息。

上面实现的 `my_abs` 函数还不够完善，使用Python的内置函数 `isinstance()` 和 `raise` 语句来实现类型检查并报错的功能，如下：

```python
def my_abs(x):
    if not isinstance(x, (int, float)):
        raise TypeError('bad operand type')
    if x >= 0:
        return x
    else:
        return -x
```

效果：

```python
>>> my_abs('a') # 参数类型错误
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 3, in my_abs
TypeError: bad operand type
>>> my_abs(1,2) # 参数个数错误
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: my_abs() takes 1 positional argument but 2 were given
```

---

### 返回多个值

举一个返回坐标点的例子：

```python
import math

def move(x, y, step, angle=0):
    nx = x + step * math.cos(angle)
    ny = y - step * math.sin(angle)
    return nx, ny
```

这里用到math包的函数 `cos` 和 `sin`，返回坐标点的两个维度的值。接收时：

```python
>>> x, y = move(100, 100, 60, math.pi / 6)
>>> print(x)
151.96152422706632
>>> print(y)
70.0
```

或者：

```python
>>> r = move(100, 100, 60, math.pi / 6)
>>> print(r)
(151.96152422706632, 70.0)
```

实际上，在Python中，函数返回的仍然是一个变量，但**在返回多个值时，Python会将它们合并为一个tuple返回**，又因为语法上返回一个tuple可以省略括号，所以可以直接写成返回多个值的形式。 特别地，我们可以使用多个变量来接收一个返回的tuple，Python会按位置顺序来赋对应的值。

---

<br>

## 函数的参数

定义函数的时候，我们把参数的名字和位置确定下来，函数的接口定义就完成了。

Python的函数定义非常简单，但灵活度却非常大。除了正常定义的必选参数外，还可以使用默认参数、可变参数和关键字参数。

### 位置参数

传入值按位置顺序依次赋给参数。

```python
def power(x, n):
    s = 1
    while n > 0:
        n = n - 1
        s = s * x
    return s
```

如这个幂函数，调用时使用 `power(5,2)` 这样的格式即可，5和2会按位置顺序分别被赋给变量x和n。

---

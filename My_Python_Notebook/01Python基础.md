# Python基础

## 数据类型和变量

### 数据类型

Python可以直接表达的数据类型包括：整数，浮点数，复数，字符串，布尔值和空值。

##### 整数 int

任意大小，正负皆可。并且可以用0b、0o、0x分别表示二进制、八进制和十六进制数：

```python
>>> 0b10 # 也可以是 0B10
2
>>> 0o10 # 也可以是 0O10
8
>>> 0x10 # 也可以是 0X10
16

# 十进制转其他进制
>>> bin(2)
'0b10'
>>> oct(8)
'0o10'
>>> hex(16)
'0x10'

# 其他进制转十进制（也可将字符串转换为十进制）
>>> int(0b10) # 也可以是 int('10', 2)
2
>>> int(0o10) # 也可以是 int('10', 8)
8
>>> int(0x10) # 也可以是 int('10', 16)
16
```

##### 浮点数

除了普通的写法之外，也可使**用科学记数法**，即1.23x10^9就是1.23e9 ，0.000012可以写成1.2e-5，等等。

**整数运算永远是精确的(结果也是整数)，浮点数运算则有四舍五入的误差**。

Python提供两种除法+求余运算：

| 符号 | 用途 |
| :-:  | :-:  |
|**`/`**|结果为浮点数，即使两数整除，**结果也是浮点数**|
|**`//`**|结果为整数，也称地板除，对**结果向下取整**|
|**`%`**|结果为整数，用于计算余数|

##### 复数

Python中复数用j表示虚数部分，比如说 `x=2.4 + 5.6j`， 并且可以通过复数的类属性 `real` 取得实部，类属性 `imag` 取得虚部，通过类方法 `conjugate()` 获得共轭复数。

```python
>>> x = 2.4 + 5.6j
>>> x.real
2.4
>>> x.imag
5.6
>>> x.conjugate()
(2.4-5.6j)
```

##### 字符串

使用单引号或双引号括起。而引号本身需要使用转义符` \ `来表达。 用` \' `来表示` ' `。

转义符还可以用来转义很多字符，如` \n `表示换行。` \t `表示制表符。 ` \ `本身也需要转义用 **双斜杠** 来代替。

如果一个字符串中很多字符都要转义就会很麻烦，所以Python又提供一种简便的写法，**` r'' `表示两个引号之间的内容是不需要转义的**。 对于多行的字符串，为了避免加入` \n `的不方便，可以使用` '''something''' `的格式，即**用三个引号来括起字符串，换行会被保留**。

```python
# 没使用三引号
>>> a = '123
  File "<stdin>", line 1
a = '123
   ^
SyntaxError: EOL while scanning string literal

# 使用了三引号
>>> a = '''123
... 456
... 789'''
>>> a
'123\n456\n789'
```

##### 布尔值

只有True和False两种，首字母大写。如果输入一个判断式，则Python会给出布尔值的结果。比方说输入3>2，运行后会得到True。 对于布尔值有三个逻辑运算符，分别是and，or和not。 **本质上True用1存储，False用0存储**。

```python
>>> 1 == 1
True
>>> 1 == True
True
>>> 0 != 0
False
>>> 0 == False
True
```

##### 空值

Python中用None表示，**不同于数值0**。数值0是有意义的，而None是一个特殊的空值。可以将None赋值给变量，但无法创建None以外的其他NoneType对象。

```python
>>> type(None)
<class 'NoneType'>
>>> a = None
>>> type(a)
<class 'NoneType'>
>>> None == a
True
>>> None == ''
False
>>> None == 0
False
```

---

### 变量

**Python是一门动态类型语言**，这意味着在Python中，**可以反复把任意数据类型的对象赋值给同一个变量**，相比起静态语言更加地灵活。

在Python中变量名不可以以数字开头，构成可以包括大小写英文，数字及下划线。

当我们写：a=’ABC’ 时，Python解释器干了两件事情：

1. 在内存中创建了一个值为`'ABC'`的字符串对象；
2. 在内存中创建了一个名为a的变量，并把它指向对象`'ABC'`。

---

### 常量

**Python中没有常量**，因为变量都可以重复赋值。但是一般**约定用全部字母大写的单词来表示一个常量**，如：PI=3.14。

---

<br>

## 字符串和编码

### 字符编码

- ASCII
> 最早的编码，包含大小写英文，数字及一些符号。大写A编码为65，小写a编码为97。字符0编码为48。使用8位二进制组合(1个字节)，可表示128个不同字符(最高位用于校验)。

- GB2312
> 处理中文时一个字节显然不足，至少需要用两个字节，并且不与ASCII冲突，因为有了中国自己制定的GB2312编码，可用于编码中文。

- Shift_JIS和Euc-kr
> 日本编码为Shift_JIS，韩文编码为Euc-kr。这样各个国家都用自己不同的标准和编码就很容易在多语言的环境产生冲突，变成乱码。因此又有了通用的一套编码。

- Unicode
> Unicode将所有语言统一到一套编码中，一般使用2个字节，部分非常偏僻的字符会用到4个字节。但是使用Unicode编码，如果在大量英文的环境又非常浪费空间，因为存储和传输时大小是使用ASCII编码的两倍，不划算，于是又有了新的方式。

- UTF-8
> UTF-8是可变长编码，对Unicode字符不同的数字大小编码成1-6个字节，英文字母为1个字节，汉字一般是3个字节。需要用到4-6字节的字符非常少，这样比较节省空间。

**Example**：

| 字符 | ASCII | Unicode  | UTF-8 |
|:------:|:------:|:------:|:------:|
| A | 01000001 | 00000000 01000001 | 01000001 |
| 中 | (超出范围) | 01001110 00101101 | 11100100 10111000 10101101 |

#### 插播一段课外知识

摘录整理自知乎提问[为什么不少网站使用 UTF-8 编码？](https://www.zhihu.com/question/19817672)。

为什么要分Unicode和UTF-8，它们两者有什么区别和关联呢？

其实最早的时候，由于各地区使用的编码方式不同，使用不同语言的人交流就成了一个大问题。ISO组织制订了统一的**通用字符集（Universal Character Set，UCS）**，也**简称为Unicode**。**目前实际应用的Unicode版本对应于UCS-2编码方式**，使用16位的编码空间。也就是每个字符占用2个字节。这样理论上一共最多可以表示 2^16 也即 65536 个字符，基本满足各种语言的使用。

Unicode的**实现方式不同于编码方式**。一个字符的Unicode编码是确定的。但是在实际传输过程中，由于不同系统平台的设计不一定一致，以及出于节省空间的目的，对**Unicode编码的实现方式有所不同**。**Unicode的实现方式称为Unicode转换格式（Unicode Transformation Format，简称为UTF）**。

例如，如果一个仅包含ASCII字符(只需要7位)的Unicode文件，如果每个字符都使用2字节的**原Unicode编码**传输，其第一字节的首位始终为0。这就造成了比较大的浪费。对于这种情况，可以使用**UTF-8编码，这是一种变长编码，它将ASCII字符仍用7位编码表示，占用一个字节（首位补0）**。而遇到与其他Unicode字符混合的情况，将按一定算法转换，每个字符使用1-3个字节编码，并利用首位为0或1进行识别。这样对以ASCII字符为主的西文文档就大大节省了编码长度。

但是，**现在所说的Unicode一般都指的是字符集而非编码方式**，廖雪峰老师在教程里提到的Unicode编码实际上指的是UCS-2这种编码方式。又因为以前UCS-2和UTF-16是等价的，所以微软的文档习惯把UTF16称为Unicode，这也导致很多开发者容易对此产生误会。

#### 其他内容

在计算机存储中，内存统一使用Unicode编码，而硬盘保存或者传输数据就用UTF-8编码。比方说打开记事本时，数据会从硬盘中UTF-8编码格式转换为Unicode格式，保存时则相反。

浏览网页时，服务器端动态生成的内容是Unicode编码，而传输时则会变为传输UTF-8编码格式的网页。所以常常在网页源码中看到 `<meta charset="UTF-8" />`的语句，表示该网页正是用的UTF-8编码。

**按我的理解，可以这样总结：在传输/储存时，为了节省带宽/空间，会使用UTF-8这样的Unicode字符集的实现方式；而在计算机要处理的时候，应当使用原Unicode编码方式，也即每个字符都是固定两字节，这样字符长度统一更便于操作。**

关于Python3中编码的信息，可以再看看[官方文档](https://docs.python.org/3/howto/unicode.html#introduction-to-unicode)。

***

### 字符串：

Python中，**字符串类型中的每个字符采用的是两字节的Unicode编码**，支持多语言。

#### ord函数

ord函数可以**获取字符的十进制整数表示**：

```python
>>> ord('中')
20013
>>> ord('文')
25991
```
注意只能传入**单个字符**。

#### chr函数

chr函数可以**将十进制整数转换为Unicode编码下对应的字符**。

```python
>>> chr(20013)
'中'
>>> chr(25991)
'文'
```

此外,如果知道了字符的十进制编码，可以将其转换为十六进制，然后**使用`\u`转义得到对应的Unicode字符**：

```python
>>> hex(20013)
'0x4e2d'
>>> '\u4e2d'
'中'
>>> hex(25991)
'0x6587'
>>> '\u6587'
'文'
>>> '\u4e2d\u6587' # 多个字符
'中文'
```

补充一下，Unicode编码是多语言的，不仅限于中文和英文，还可以使用多种语言的字符及符号：

```python
In [1]: ord('한') # 韩语
Out[1]: 54620
In [2]: hex(54620)
Out[2]: '0xd55c'
In [3]: '\ud55c'
Out[3]: '한'

In [4]: ord('に') # 日语
Out[4]: 12395
In [5]: hex(12395)
Out[5]: '0x306b'
In [6]: '\u306b'
Out[6]: 'に'

In [7]: ord('a') # 英语
Out[7]: 97
In [8]: hex(97)
Out[8]: '0x61'
In [9]: '\u0061'
Out[9]: 'a'

In [10]: ord('1') # 数字
Out[10]: 49
In [11]: hex(49)
Out[11]: '0x31'
In [12]: '\u0031'
Out[12]: '1'

In [13]: ord(',') # 符号
Out[13]: 44
In [14]: hex(44)
Out[14]: '0x2c'
In [15]: '\u002c'
Out[15]: ','
```

从以上代码可以看到，这里的Unicode编码中**每个字符都是固定用两字节表示（一个字符用4位16进制数表示，每个16进制数需要4bit，所以一共是4*4 = 16bits = 2bytes）**，**和廖老师教程中所说的若干个字节不一致，是否真的有多于两字节的Unicode字符呢？有待考究。**

#### bytes类型

因为Python程序执行时，字符串类型是用Unicode编码的，一个字符对应若干字节（**若干字节还是固定两个字节呢？**），要在网络中传输或存储到硬盘中就要把字符串变为bytes类型（**因为传输和存储都是以字节为单位的，所以需要进行转换。又因为要节省资源，所以会使用别的编码方式如utf-8**）。

Python显示bytes类型的数据会用b作前缀，要注意 **`b'ABC'`** 和 **`'ABC'`** 的差别，尽管内容一样，但前者的每个字符都只占1个字节，而后者在Python中以Unicode进行编码，每个字符占两个字节。也即：

```python
>>> b'\x41\x42\x43'      # bytes类型，每个英文字符占1个字节
b'ABC'
>>> '\u0041\u0042\u0043' # Unicode类型，每个英文字符占2个字节，前8bit用0填充
'ABC'
```

Unicode字符串可以通过 **`encode()`** 方法编码为指定的bytes，如ASCII编码，utf-8编码etc，bytes类型的数据如果字符不属于ASCII码的范围，就用 **`'\x##`** 的格式表示。 相应地，如果读取字节流的数据，就要用 **`decode()`** 方法解码。例如：

```python
>>> 'ABC'.encode('ascii')
b'ABC'
>>> '中文'.encode('utf-8')
b'\xe4\xb8\xad\xe6\x96\x87'

>>> b'ABC'.decode('ascii')
'ABC'
>>> b'\xe4\xb8\xad\xe6\x96\x87'.decode('utf-8')
'中文'
```

#### len函数

**对字符串使用len函数会得到字符的数目**，而**对字节流使用len函数则会得到有多少字节**。例如：

```python
>>> len('中文') # 字符串'中文'包含两个字符
2
>>> len('\u4e2d\u6587') # 用4个字节表示字符串'中文'
2
>>> len('中文'.encode('utf-8')) # 字符串'中文'编码为utf-u格式后，占6个字节
6
>>> len(b'\xe4\xb8\xad\xe6\x96\x87') # 用6个字节表示字节流'中文'
6

>>> len('ABC') # 字符串'ABC'包含三个字符
3
>>> len('\u0041\u0042\u0043') # 用6个字节表示字符串'ABC'
3
>>> len('ABC'.encode('ascii')) # 字符串'ABC'编码为ASCII格式后，占3个字符
3
>>> len(b'\x41\x42\x43') # 用3个字节表示字节流'ABC'
3
```

***

